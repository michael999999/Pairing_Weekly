產出「單一檔案」供回測使用，內含每週收盤與下一交易日收盤（T+1 close）。

輸入
- 檔案：data/prices.pkl
- 結構：pandas DataFrame（DatetimeIndex，日頻、欄名為標的代碼、值為 adjusted close）

輸出（單一檔）
- 檔名：data/weekly_prices.pkl
- 結構：pandas DataFrame（週頻，索引為每週最後一個實際交易日；columns 為 MultiIndex）
  - level 0：標的代碼（與原始欄名一致）
  - level 1：欄位名稱，固定為：
    - W_Close：該週最後一個交易日的收盤（adjusted close）
    - T1_Close：該週最後一個交易日之後「下一個有效交易日」的收盤（用於 T+1 成交）

語義與規則
- 週界定：W-FRI（以週五為週末；若週五休市則用該週最後一個交易日）
- W_Close：每檔在該週內「最後一個有價日」的日收盤；整週無價則為 NaN
- T1_Close：對應 W_Close 當日之後的「下一個有價日」的日收盤；若樣本尾端或停牌導致沒有下一日，則為 NaN（該週不可交易）
- 多市場/假期：T1_Close 逐檔計算（每個 symbol 按自身交易日曆找下一個交易日），對齊到週末索引
- 不做 forward fill；NaN 保留以利回測時過濾

檢核與邊界
- 驗證 W_Close 等於該週最後有價日的日收盤
- 驗證 T1_Close 確為 W_Close 之後的下一個有價日收盤
- 最後一週通常沒有 T1_Close（NaN），請在回測時剔除
- 若某週任一檔的 W_Close 或 T1_Close 為 NaN，則該週該對不可下單

用法（回測解讀）
- 週 t：以 W_Close 計算配對殘差與 z-score
- 若觸發訊號，於週 t 的 T1_Close 作為實際進/出場成交價
- 成本：每腿每邊 5 bps（預設），後續在回測層實作；此檔僅存價格

欄位示例（示意）
- columns: [(SYM1, W_Close), (SYM1, T1_Close), (SYM2, W_Close), (SYM2, T1_Close), ...]
- index: 週末日期，例如 2023-09-15, 2023-09-22, ...
